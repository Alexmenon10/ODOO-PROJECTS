<?xml version="1.0" encoding="UTF-8"?>
<odoo>
	<data>

          <!-- purchase_Indent Form View -->
        <record id='view_purchase_indent_indent_form' model='ir.ui.view'>
			<field name="name">purchase.indent.form</field>
			<field name="model">purchase.indent</field>
			<field name="arch" type="xml">
				<form string="Indents">
					<header>
						<button name="purchase_indent_confirm" string="Confirm" states="draft" type="object"
							class="oe_highlight"/>
						<button name="purchase_indent_create" string="Create Purchase Order" type="object"
							class="oe_highlight" attrs="{'invisible':['|',('store_type','!=','purchase'),('state','!=','inprogress')]}"/>
						<!--<button type="object" name="action_assign" string="Approve"
							class="oe_highlight"
								attrs="{'invisible': ['|',('item_for', '!=', 'purchase'),('state', '!=', 'waiting_approval')]}"/>-->
						<button name="purchase_indent_inprogress" string="Approve" type="object"
							class="oe_highlight"
								attrs="{'invisible': ['|',('item_for', '=', 'purchase'),('state', '!=', 'waiting_approval')]}"/>
						<button name="indent_reject" string="Reject" states="waiting_approval,inprogress,move_created" type="object"
							/>
						<button name="indent_transfer" string="Ready To Transfer" type="object"
								class="oe_highlight" attrs="{'invisible':['|',('store_type','=','purchase'),('state','!=','inprogress')]}"/>
						<button name="indent_transfer_move_confirm" string="Confirm Transfer" type="object"
								class="oe_highlight" attrs="{'invisible':['|',('store_type','=','purchase'),('state','!=','move_created')]}"/>
						<field name="state" widget="statusbar"
							statusbar_visible="draft,waiting_approval,inprogress,move_created,done"
							statusbar_colors='{"reject":"red"}' />
					</header>
					<sheet>
						<h1>
							<field name="name" class="oe_inline" readonly="1"/>
						</h1>
						<group>
							<group>
							
<!-- 							<field name="res_partner" options="{'no_open': True,'no_create':True}"/> -->
								<field name="company_id" invisible="1"/>
								<field name="indent_creator_name"/>
								<field name="requirement"/>
                                <field name="issued_by" />
                                <field name="location_id" invisible="1"/>
							</group>
							<group>
								<field name="store_type" attrs="{'readonly':[('state','!=','draft')]}" required="1"/>
								<field name="indent_date" />
								<field name="required_date" />
								<field name="issued_date" />
							</group>
						</group>
						<notebook>
							<page string="Products" attrs="{'invisible':[('item_for', '=', 'purchase')]}">
								<field name="product_lines">
<!--									<form string="Products">-->
<!--										<group>-->
<!--											<group>-->
<!--												<field name="unknown_product"/>-->
<!--												<field name="product_id" />-->
<!--												<field name="product_category"/>-->
<!--&lt;!&ndash;-->
<!--												on_change="onchange_product_id(product_id, product_uom_qty, product_uom, name)"-->
<!--&ndash;&gt;-->
<!--												&lt;!&ndash;<field name="res_partner" invisible="1" domain="[('company_type','=','company')]"/>&ndash;&gt; -->
<!--												<label for="product_uom_qty" />-->
<!--												<div>-->
<!--													<field name="product_uom_qty" class="oe_inline" />-->
<!--													<field name="product_uom"-->
<!--														class="oe_inline oe_no_button"-->
<!--														 />-->
<!--&lt;!&ndash;-->
<!--												   on_change="onchange_product_id(product_id, product_uom_qty,-->
<!--														product_uom, name)"-->
<!--&ndash;&gt;-->
<!--												</div>-->
<!--											</group>-->
<!--										</group>-->
<!--										-->
<!--										<group col="2">-->
<!--										<group>-->
<!--										-->
<!--											<field name="name"/>-->
<!--											<field name="state"/>-->
<!--										</group>-->
<!--											<group string ="Locations">-->
<!--											<field name="location_id" domain="[('usage','in',['internal','customer'])]" options="{'no_open': True,'no_create':True}"/>-->
<!--											<field name="location_dest_id" domain="[('usage','in',['internal','customer'])]" options="{'no_open': True,'no_create':True}"/>-->
<!--										</group>-->
<!--										</group>-->
<!--										<group string="Product Availability">-->
<!--											<field name="current_location_ids" colspan="4" nolabel="1">-->
<!--												<tree create="false" editable="bottom" delete="false">-->
<!--													<field name="current_location_id" string="Warehouse" options="{'no_open': True,'no_create':True}"/>-->
<!--													<field name="quantity" />-->
<!--												</tree>-->
<!--											</field>-->
<!--										</group>-->

<!--										-->
<!--										<group>-->
<!--											<field name="location_dest_id" invisible="1" options="{'no_open': True,'no_create':True}"/>-->
<!--										</group>-->
<!--									</form>-->
                                    <tree string="Products" editable="bottom">
										<field name="unknown_product"/>
                                        <field name="sequence" widget="handle"/>
                                        <field name="product_id"/>
                                        <field name="state" invisible="1"/>
                                        <field name="product_uom_qty" sum="Total Qty"/>
                                        <field name="product_uom" string="Unit"/>
                                        <field name="location_id"/>
                                        <field name="location_dest_id"/>
										<field name="name"/>
										<field name="product_category"/>
                                    </tree>
								</field>
								<div class="oe_clear">
									<label for="description" />
								</div>
								<field name="description" class="oe_inline" placeholder="Additional note..." />
							</page>

							<page string="Moves" attrs="{'invisible':[('store_type','=','purchase')]}">
								<field name="move_lines">
									<tree string="Products" colors="grey:state == 'cancel';black:state == 'done';red:(state not in ('cancel','done')) and date > current_date;blue:(state not in ('cancel','done'))">
                                        <field name="product_id"/>
										<field name="name"/>
										<field name="product_uom_qty"/>
										<field name="product_uom" />
                                        <field name="state" invisible="1"/>
                                        <field name="location_id"/>
                                        <field name="location_dest_id"/>
										<field name="purchase_indent_id" invisible="1"/>
										<field name="date" invisible="1"/>
                                    </tree>
								</field>
								<div class="oe_clear">
									<label for="description" />
								</div>
								<field name="description" class="oe_inline" placeholder="Additional note..." />
							</page>
							<page string="Other Info">
								<group>
									<group><field name="item_for" readonly="True"/></group>
								</group>
							</page>
						</notebook>
					</sheet>
				</form>
			</field>
		</record>

		 <!-- purchase Indent Tree View -->
        <record id='view_purchase_indent_indent_tree' model='ir.ui.view'>
			<field name="name">purchase.indent.tree</field>
			<field name="model">purchase.indent</field>
			<field name="arch" type="xml">
				<tree string="Indents">
					<field name="name" />
					<field name="indent_date" />
					<field name="required_date" />
					<field name="requirement" invisible="1"/>
					<field name="state" />
				</tree>
			</field>
		</record>

        <!-- Indent Window Action -->
		<record id='menu_purchase_indent_indent' model='ir.actions.act_window'>
			<field name="name">Indents</field>
			<field name="res_model">purchase.indent</field>
			<!--<field name="view_type">form</field>-->
			<field name="view_mode">tree,form</field>
			<field name="domain">[('state', 'in', ('draft','waiting_approval','inprogress','move_created','done','reject'))]</field>
			<field name="view_ids"
                   eval="[(5, 0, 0),
                          (0, 0, {'view_mode': 'tree', 'view_id': ref('view_purchase_indent_indent_tree')}),
                          (0, 0, {'view_mode': 'form', 'view_id': ref('view_purchase_indent_indent_form')})]"/>

			<field name="help" type="html">
				<p class="oe_view_nocontent_create">
					Click to create a new indent.
				</p>
			</field>
		</record>
<!--        <menuitem id="menu_purchase_indent_main" name="Indents" parent="approvals.approvals_menu_config" sequence="10"/>-->
<!--        <menuitem action="menu_purchase_indent_indent" id="menu_purchase_production_order_indent_action" name="Indents" parent="menu_purchase_indent_main" sequence="1"/>-->

        <!-- Indent Window purchase order button -->
        <record id="purchase_order_Indent" model="ir.ui.view">
         <field name="name">purchase.indent.order1</field>
         <field name="model">purchase.indent</field>
         <field name="inherit_id" ref="purchase_indent.view_purchase_indent_indent_form"/>
         <field name="arch" type="xml">
               <xpath expr="//h1" position="inside">

				<div class="pull-right">
					<div name="button_box" position="inside">
					<button string="Purchase" icon="fa-shopping-cart"
                     type="object" class="oe_stat_button" name="prepare_order_line_purchase_order" attrs="{'invisible':[('store_type','=','purchase')]}"/>
						<button class="oe_stat_button" type="object" name="get_purchase_orders" attrs="{'invisible':[('store_type','!=','purchase')]}"
                        	icon="fa-shopping-cart">
                        <field string="RFQ" name="purchase_count" widget="statinfo"/>
                    </button>
                	</div>
            	</div>
             </xpath>
         </field>
      </record>

    </data>
</odoo>
